datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int       @id @default(autoincrement())
  name      String
  email     String    @unique
  password  String
  role      UserRole  @default(KARYAWAN)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Product {
  id        Int              @id @default(autoincrement())
  code      String           @unique
  name      String
  brand     String
  price     Int
  category  ProductCategory
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt

  batches   ProductBatch[]   // Relasi ke batch
}

model ProductBatch {
  id           Int       @id @default(autoincrement())
  productId    Int
  entryDate    DateTime
  expiredDate  DateTime?    // Bisa null jika ALKES
  stock        Int
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt

  product      Product      @relation(fields: [productId], references: [id])

  @@index([productId, expiredDate])
}

enum ProductCategory {
  OBAT_KERAS
  OBAT_BEBAS_TERBATAS
  KONSI
  ALKES
}

enum UserRole {
  KARYAWAN
  OWNER
}
